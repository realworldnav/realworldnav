<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Structured data – Shiny for Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="genai-rag.html" rel="next">
<link href="genai-tools.html" rel="prev">
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-888ef42a095209a13a17dbfda2cb877d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-06a6b8726800c70458725a52052b40c7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
  // Redirect URLs like https://shiny.posit.co/py to
  // https://shiny.posit.co/py/ (with trailing slash). This is needed for
  // relative paths to work correctly. Unfortunately, Netlify cannot have a
  // redirect that adds or removes a trailing slash.
  if (
    !window.location.pathname.endsWith(".html") &&
    !window.location.pathname.endsWith("/")
  ) {
    window.location.replace(window.location.href + "/");
  }
</script>

<!-- Google Tag Manager -->
<script>
  // prettier-ignore
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KHBDBW7');
</script>
<!-- End Google Tag Manager -->

<!-- Add rel="noopener noreferrer" to each target="_blank" -->
<script type="text/javascript">
  window.addEventListener("load", () =>
    [...document.querySelectorAll("a[target=_blank]")].forEach((lnk) =>
      lnk.setAttribute("rel", "noopener noreferrer")
    )
  );
</script>
<!-- End Add rel="noopener noreferrer" to each target="_blank" -->

<script type="text/javascript">
  (function () {
    function addShinyliveEditLinks() {
      const codeWithLink = document.querySelectorAll(
        ".sourceCode[data-shinylive]"
      );
      codeWithLink.forEach((el) => {
        el.classList.add("code-with-shinylive-link");
        const url = el.dataset.shinylive;

        // <a class="edit-shinylive-button btn btn-link" href="https://shiny.posit.co/py/docs/&lt;%=&#32;app.shinylive&#32;%&gt;" data-bs-toggle="tooltip" data-bs-title="Edit in Shinylive" data-bs-placement="bottom">
        //  <i class="bi bi-lightning-fill"></i> <span class="visually-hidden">Edit in Shinylive</span>
        // </a>

        const link = document.createElement("a");
        link.classList.add("edit-shinylive-button", "btn", "btn-link");
        link.href = url;
        link.dataset.bsToggle = "tooltip";
        link.dataset.bsTitle = "Edit in Shinylive";
        link.dataset.bsPlacement = "bottom";

        const icon = document.createElement("i");
        icon.classList.add("bi", "bi-lightning-fill");
        link.appendChild(icon);

        const span = document.createElement("span");
        span.classList.add("visually-hidden");
        span.innerText = "Edit in Shinylive";
        link.appendChild(span);

        const btnCopy = el.querySelector(".code-copy-button");
        if (btnCopy) {
          btnCopy.parentElement.appendChild(link);
        } else {
          if (el.matches("pre")) {
            el.appendChild(link);
          } else {
            el.querySelector("pre").appendChild(link);
          }
        }

        if (window.bootstrap?.Tooltip) {
          new bootstrap.Tooltip(link);
        }
        el.removeAttribute("data-shinylive");
      });
    }

    function addWhatsShinyExpressTooltip() {
      const tooltipContents = `<p><strong>Shiny Express</strong> is a new, streamlined way to write a Shiny app.</p>
    <p><strong>Shiny Core</strong> refers to the original, functional Shiny syntax, which is still a great way to write Shiny apps.</p>
    <p class="fw-600" style="font-size:0.85em;"><a href="https://shiny.posit.co/blog/posts/shiny-express/">Read more <i class="bi bi-chevron-right align-text-top"></i></a></p>`;

      const tooltipDisplay = `<i class="bi bi-question-circle-fill d-inline d-sm-none"></i><span class="d-none d-sm-inline">What's this?</span>`;

      document
        .querySelectorAll(".panel-tabset.shiny-mode-tabset")
        .forEach(function (tabset) {
          const trigger = document.createElement("div");
          trigger.classList.add("what-shiny-express", "text-white");
          trigger.tabIndex = 0;
          trigger.innerHTML = tooltipDisplay;
          tabset.appendChild(trigger);

          if (!window.bootstrap?.Popover) {
            return;
          }

          new window.bootstrap.Popover(trigger, {
            html: true,
            title: "Express vs Core",
            content: tooltipContents,
            placement: "auto",
            trigger: "focus",
            container: tabset,
          });
        });
    }

    function handlePanelVariants() {
      document.querySelectorAll(".panel-pills > .nav").forEach((x) => {
        x.classList.remove("nav-tabs");
        x.classList.add("nav-pills");
      });
      document.querySelectorAll(".panel-underline > .nav").forEach((x) => {
        x.classList.remove("nav-tabs");
        x.classList.add("nav-underline");
      });
      document.querySelectorAll(".shiny-mode-tabset > .nav").forEach((x) => {
        x.classList.remove("nav-tabs");
        x.classList.add("nav-underline");
      });
    }

    function onLoad() {
      addShinyliveEditLinks();
      addWhatsShinyExpressTooltip();
      handlePanelVariants();
    }

    document.readyState === "loading"
      ? document.addEventListener("DOMContentLoaded", onLoad)
      : onLoad();
  })();
</script>

<!-- <div
  class="alert alert-primary text-center mb-0 border-0"
  style="padding: 0.6rem"
  role="alert"
>
  <p class="d-md-inline my-0 me-md-4 p-90">
    <strong>🎉 Introducing Shiny Express</strong>
  </p>
  <p class="d-md-inline my-0 p-90 me-md-4">
    A simpler way to write and learn Shiny.
  </p>
  <p class="d-md-inline my-0 p-90 me-md-4">
    <a
      href="https://shiny.posit.co/blog/posts/shiny-express/"
      target="_blank"
      style="color: #00314e"
      >Learn more</a
    >.
  </p>
</div> -->


<meta property="og:title" content="Structured data – Shiny for Python">
<meta property="og:description" content="Build interactive web applications easily with the power of Python’s data and scientific stack.">
<meta property="og:image" content="https://shiny.posit.co/py/images/shiny-for-python.jpg">
<meta property="og:site_name" content="Shiny for Python">
<meta property="og:locale" content="es_ES">
<meta name="twitter:title" content="Shiny for Python">
<meta name="twitter:description" content="Build interactive web applications easily with the power of Python’s data and scientific stack.">
<meta name="twitter:image" content="https://shiny.posit.co/py/images/shiny-for-python.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../shiny-for-python.svg" alt="The logo for Shiny for Python" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Shiny for Python</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../get-started/index.html"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="overview.html" aria-current="page"> 
<span class="menu-text">Concepts</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="genai-structured-data.html#" id="nav-menu-components" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Components</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-components">    
        <li>
    <a class="dropdown-item" href="../components/index.html"><i class="bi bi-sliders" role="img">
</i> 
 <span class="dropdown-text">Components</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../layouts/index.html"><i class="bi bi-layout-text-window-reverse" role="img">
</i> 
 <span class="dropdown-text">Layouts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../templates/index.html"><i class="bi bi-code-square" role="img">
</i> 
 <span class="dropdown-text">Templates</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../gallery/index.html"> 
<span class="menu-text">Gallery</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://shinylive.io/py/examples/" target="_blank"> 
<span class="menu-text">Playground</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="genai-structured-data.html#" id="nav-menu-reference" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reference</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-reference">    
        <li>
    <a class="dropdown-item" href="../api/express/index.html">
 <span class="dropdown-text">Shiny Express</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/core/index.html">
 <span class="dropdown-text">Shiny Core</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/testing/index.html">
 <span class="dropdown-text">Testing</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://discord.gg/yMGCamUMnS" title="" class="quarto-navigation-tool px-1" aria-label="Shiny Discord"><i class="bi bi-discord"></i></a>
    <a href="https://github.com/posit-dev/py-shiny/" title="" class="quarto-navigation-tool px-1" aria-label="Shiny for Python Github"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="genai-inspiration.html"><span class="emoji-icon">🤖</span> <strong>Generative AI</strong></a></li><li class="breadcrumb-item"><a href="genai-structured-data.html">Structured data</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">📌</span> <strong>Essentials</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="user-interfaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">User interfaces</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">🤖</span> <strong>Generative AI</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="genai-inspiration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get inspired</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="genai-chatbots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chatbots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="genai-stream.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Streaming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="genai-tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tool calling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="genai-structured-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Structured data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="genai-rag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RAG</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">🎨</span> <strong>User interfaces</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="ui-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="jupyter-widgets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Jupyter Widgets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="ui-dynamic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamic UI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="ui-html.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UI as HTML</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="ui-customize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Customizing UI</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">⚡</span> <strong>Reactivity</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="reactive-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foundations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="reactive-patterns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="reactive-mutable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mutable objects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">📝</span> <strong>Syntax modes</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="express-vs-core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Express vs.&nbsp;Core</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="express-or-core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Choosing a syntax</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="express-in-depth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Express in depth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="express-to-core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transition to Core</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">📦</span> <strong>Modules</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="modules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shiny Modules</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="module-communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module Communication</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">🧪</span> <strong>Testing</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="unit-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="end-to-end-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">End-to-End Testing Your App</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">🏗️</span> <strong>Extending</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="custom-component-one-off.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom JavaScript component</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="custom-components-pkg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom components package</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">📊</span> <strong>Comparisons</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="comp-streamlit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Streamlit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="comp-r-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shiny for R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text"><span class="emoji-icon">🧩</span> <strong>Miscellaneous</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="nonblocking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Non-blocking operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="routing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Routing</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="genai-structured-data.html#intro-to-.extract_data" id="toc-intro-to-.extract_data" class="nav-link active" data-scroll-target="#intro-to-.extract_data">Intro to <code>.extract_data()</code></a></li>
  <li><a href="genai-structured-data.html#basic-app" id="toc-basic-app" class="nav-link" data-scroll-target="#basic-app">Basic app</a></li>
  <li><a href="genai-structured-data.html#editable-data" id="toc-editable-data" class="nav-link" data-scroll-target="#editable-data">Editable data</a></li>
  <li><a href="genai-structured-data.html#populating-inputs" id="toc-populating-inputs" class="nav-link" data-scroll-target="#populating-inputs">Populating inputs</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/posit-dev/py-shiny-site/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li><li><a href="https://github.com/posit-dev/py-shiny-site/edit/main/docs/genai-structured-data.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHBDBW7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="genai-inspiration.html"><span class="emoji-icon">🤖</span> <strong>Generative AI</strong></a></li><li class="breadcrumb-item"><a href="genai-structured-data.html">Structured data</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Structured data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>LLMs are quite good at extracting structured data from unstructured text, images, and more. Although not always perfect, they can greatly reduce the manual work needed to extract information from large amounts of text or documents. Here are just a few scenarios where this can be useful:</p>
<ol type="1">
<li><strong>Form processing</strong>: Extract structured field-value pairs from scanned documents, invoices, and forms to reduce manual data entry.</li>
<li><strong>Automated table extraction</strong>: Identify and extract tables from unstructured text and images.</li>
<li><strong>Sentiment analysis</strong>: Extract sentiment scores and associated entities from customer reviews or social media posts to gain insights into public opinion.</li>
<li><strong>Classification</strong>: Classify text into predefined categories, such as spam detection or topic classification.</li>
<li><strong>Executive summaries</strong>: Extract key points and structured data from lengthy reports or articles to create concise summaries for decision-makers.</li>
</ol>
<section id="intro-to-.extract_data" class="level2">
<h2 class="anchored" data-anchor-id="intro-to-.extract_data">Intro to <code>.extract_data()</code></h2>
<p>The <a href="https://posit-dev.github.io/chatlas/"><code>chatlas</code> package</a> provides a simple way to extract structured data: the <a href="https://posit-dev.github.io/chatlas/reference/Chat.html#chatlas.Chat.extract_data"><code>.extract_data()</code> method</a>. To use it, you’ll need three things:</p>
<ol type="1">
<li>Pick a <a href="https://posit-dev.github.io/chatlas/reference/">model provider</a> (e.g., <code>ChatOpenAI()</code>).</li>
<li>Define a data model by subclassing <code>pydantic</code>’s <code>BaseModel</code> class.
<ul>
<li>Here you’ll define the fields and value types you’re expecting in the input.</li>
</ul></li>
<li>Pass the unstructured input and <code>data_model</code> to the <code>.extract_data()</code> method.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="genai-structured-data.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> chatlas <span class="im">import</span> ChatOpenAI</span>
<span id="cb1-2"><a href="genai-structured-data.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydantic <span class="im">import</span> BaseModel</span>
<span id="cb1-3"><a href="genai-structured-data.html#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="genai-structured-data.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Person(BaseModel):</span>
<span id="cb1-5"><a href="genai-structured-data.html#cb1-5" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span></span>
<span id="cb1-6"><a href="genai-structured-data.html#cb1-6" aria-hidden="true" tabindex="-1"></a>    age: <span class="bu">int</span></span>
<span id="cb1-7"><a href="genai-structured-data.html#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="genai-structured-data.html#cb1-8" aria-hidden="true" tabindex="-1"></a>chat_client <span class="op">=</span> ChatOpenAI()</span>
<span id="cb1-9"><a href="genai-structured-data.html#cb1-9" aria-hidden="true" tabindex="-1"></a>chat_client.extract_data(</span>
<span id="cb1-10"><a href="genai-structured-data.html#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"My name is Susan and I'm 13 years old"</span>,</span>
<span id="cb1-11"><a href="genai-structured-data.html#cb1-11" aria-hidden="true" tabindex="-1"></a>  data_model<span class="op">=</span>Person,</span>
<span id="cb1-12"><a href="genai-structured-data.html#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>.extract_data()</code> then returns a dictionary matching the fields and types in the <code>data_model</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="genai-structured-data.html#cb2-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">'name'</span>: <span class="st">'Susan'</span>, <span class="st">'age'</span>: <span class="dv">13</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
More examples
</div>
</div>
<div class="callout-body-container callout-body">
<p>For more examples and details on how <code>.extract_data()</code> works, see the <a href="https://posit-dev.github.io/chatlas/structured-data.html">chatlas documentation</a>.</p>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Multi-modal input
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>chatlas</code> also supports input other than text, such as images (<a href="https://posit-dev.github.io/chatlas/reference/content_image_file.html"><code>content_image_file()</code></a>) and PDF (<a href="https://posit-dev.github.io/chatlas/reference/content_pdf_file.html"><code>content_pdf_file()</code></a>).</p>
</div>
</div>
</section>
<section id="basic-app" class="level2">
<h2 class="anchored" data-anchor-id="basic-app">Basic app</h2>
<p>To go from this basic script to a Shiny app, you’ll at least want a couple things:</p>
<ul>
<li>Change <code>.extract_data()</code> to <code>await chat_client.extract_data_async()</code>.
<ul>
<li>This helps the Shiny app scale efficiently to multiple concurrent users.</li>
<li>You could also wrap this part in a <a href="nonblocking.html">non-blocking task</a> to keep the rest of the app responsive within the same session.</li>
</ul></li>
<li>Decide how the user will provide and/or navigate the unstructured input(s).
<ul>
<li>This could be a simple text input field (as below), a <a href="../api/express/express.ui.input_file.html">file upload</a>, a <a href="genai-chatbots.html">chat interface</a>, etc.</li>
</ul></li>
</ul>
<p>For now, let’s keep it simple and use a text input field:</p>
<details open="">
<summary>
<code>app.py</code>
</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="genai-structured-data.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> chatlas <span class="im">import</span> ChatOpenAI</span>
<span id="cb3-2"><a href="genai-structured-data.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydantic <span class="im">import</span> BaseModel</span>
<span id="cb3-3"><a href="genai-structured-data.html#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="genai-structured-data.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shiny <span class="im">import</span> reactive</span>
<span id="cb3-5"><a href="genai-structured-data.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shiny.express <span class="im">import</span> <span class="bu">input</span>, render, ui</span>
<span id="cb3-6"><a href="genai-structured-data.html#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="genai-structured-data.html#cb3-7" aria-hidden="true" tabindex="-1"></a>chat_client <span class="op">=</span> ChatOpenAI()</span>
<span id="cb3-8"><a href="genai-structured-data.html#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="genai-structured-data.html#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Person(BaseModel):</span>
<span id="cb3-10"><a href="genai-structured-data.html#cb3-10" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span></span>
<span id="cb3-11"><a href="genai-structured-data.html#cb3-11" aria-hidden="true" tabindex="-1"></a>    age: <span class="bu">int</span></span>
<span id="cb3-12"><a href="genai-structured-data.html#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="genai-structured-data.html#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> ui.card():</span>
<span id="cb3-14"><a href="genai-structured-data.html#cb3-14" aria-hidden="true" tabindex="-1"></a>    ui.card_header(<span class="st">"Enter some input with name and age"</span>)</span>
<span id="cb3-15"><a href="genai-structured-data.html#cb3-15" aria-hidden="true" tabindex="-1"></a>    ui.input_text_area(</span>
<span id="cb3-16"><a href="genai-structured-data.html#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"user_input"</span>, <span class="va">None</span>, update_on<span class="op">=</span><span class="st">"blur"</span>, width<span class="op">=</span><span class="st">"100%"</span>,</span>
<span id="cb3-17"><a href="genai-structured-data.html#cb3-17" aria-hidden="true" tabindex="-1"></a>        value<span class="op">=</span><span class="st">"My name is Susan and I'm 13 years old"</span>,</span>
<span id="cb3-18"><a href="genai-structured-data.html#cb3-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-19"><a href="genai-structured-data.html#cb3-19" aria-hidden="true" tabindex="-1"></a>    ui.input_action_button(<span class="st">"submit"</span>, label<span class="op">=</span><span class="st">"Extract data"</span>)</span>
<span id="cb3-20"><a href="genai-structured-data.html#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="genai-structured-data.html#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">@render.ui</span></span>
<span id="cb3-22"><a href="genai-structured-data.html#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">@reactive.event</span>(<span class="bu">input</span>.submit)</span>
<span id="cb3-23"><a href="genai-structured-data.html#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> result():</span>
<span id="cb3-24"><a href="genai-structured-data.html#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ui.markdown(<span class="ss">f"Extracted data: `</span><span class="sc">{</span><span class="cf">await</span> data()<span class="sc">}</span><span class="ss">`"</span>)</span>
<span id="cb3-25"><a href="genai-structured-data.html#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="genai-structured-data.html#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="at">@reactive.calc</span></span>
<span id="cb3-27"><a href="genai-structured-data.html#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> data():</span>
<span id="cb3-28"><a href="genai-structured-data.html#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cf">await</span> chat_client.extract_data_async(</span>
<span id="cb3-29"><a href="genai-structured-data.html#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">input</span>.user_input(),</span>
<span id="cb3-30"><a href="genai-structured-data.html#cb3-30" aria-hidden="true" tabindex="-1"></a>        data_model<span class="op">=</span>Person,</span>
<span id="cb3-31"><a href="genai-structured-data.html#cb3-31" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/genai-structured-basic.png" class="rounded shadow mb-5 img-fluid figure-img"></p>
<figcaption>Screenshot of the basic structured data app</figcaption>
</figure>
</div>
</section>
<section id="editable-data" class="level2">
<h2 class="anchored" data-anchor-id="editable-data">Editable data</h2>
<p>Remember that the LLM is not perfect – you may want to manually correct or refine the extracted data. In this scenario, it may be useful to allow the user to edit the extracted data and download it when done. Here’s an example of how to do this in a named entity extraction app.</p>
<details>
<summary>
<code>data_model.py</code>
</summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="genai-structured-data.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydantic <span class="im">import</span> BaseModel, Field</span>
<span id="cb4-2"><a href="genai-structured-data.html#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="genai-structured-data.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NamedEntity(BaseModel):</span>
<span id="cb4-4"><a href="genai-structured-data.html#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Named entity in the text."""</span></span>
<span id="cb4-5"><a href="genai-structured-data.html#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="genai-structured-data.html#cb4-6" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span> <span class="op">=</span> Field(description<span class="op">=</span><span class="st">"The extracted entity name"</span>)</span>
<span id="cb4-7"><a href="genai-structured-data.html#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="genai-structured-data.html#cb4-8" aria-hidden="true" tabindex="-1"></a>    type_: <span class="bu">str</span> <span class="op">=</span> Field(</span>
<span id="cb4-9"><a href="genai-structured-data.html#cb4-9" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">"The entity type, e.g. 'person', 'location', 'organization'"</span></span>
<span id="cb4-10"><a href="genai-structured-data.html#cb4-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-11"><a href="genai-structured-data.html#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="genai-structured-data.html#cb4-12" aria-hidden="true" tabindex="-1"></a>    context: <span class="bu">str</span> <span class="op">=</span> Field(</span>
<span id="cb4-13"><a href="genai-structured-data.html#cb4-13" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">"The context in which the entity appears in the text."</span></span>
<span id="cb4-14"><a href="genai-structured-data.html#cb4-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-15"><a href="genai-structured-data.html#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="genai-structured-data.html#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NamedEntities(BaseModel):</span>
<span id="cb4-17"><a href="genai-structured-data.html#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Named entities in the text."""</span></span>
<span id="cb4-18"><a href="genai-structured-data.html#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="genai-structured-data.html#cb4-19" aria-hidden="true" tabindex="-1"></a>    entities: <span class="bu">list</span>[NamedEntity] <span class="op">=</span> Field(description<span class="op">=</span><span class="st">"Array of named entities"</span>)</span>
<span id="cb4-20"><a href="genai-structured-data.html#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="genai-structured-data.html#cb4-21" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> NamedEntities.model_rebuild()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>
<code>app.py</code>
</summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="genai-structured-data.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="genai-structured-data.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> chatlas <span class="im">import</span> ChatOpenAI</span>
<span id="cb5-3"><a href="genai-structured-data.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> faicons <span class="im">import</span> icon_svg</span>
<span id="cb5-4"><a href="genai-structured-data.html#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="genai-structured-data.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shiny <span class="im">import</span> reactive</span>
<span id="cb5-6"><a href="genai-structured-data.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shiny.express <span class="im">import</span> <span class="bu">input</span>, render, ui</span>
<span id="cb5-7"><a href="genai-structured-data.html#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="genai-structured-data.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> data_model <span class="im">import</span> NamedEntities</span>
<span id="cb5-9"><a href="genai-structured-data.html#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="genai-structured-data.html#cb5-10" aria-hidden="true" tabindex="-1"></a>chat_client <span class="op">=</span> ChatOpenAI()</span>
<span id="cb5-11"><a href="genai-structured-data.html#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="genai-structured-data.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> ui.card():</span>
<span id="cb5-13"><a href="genai-structured-data.html#cb5-13" aria-hidden="true" tabindex="-1"></a>    ui.card_header(<span class="st">"Named Entity Extraction"</span>)</span>
<span id="cb5-14"><a href="genai-structured-data.html#cb5-14" aria-hidden="true" tabindex="-1"></a>    ui.input_text_area(</span>
<span id="cb5-15"><a href="genai-structured-data.html#cb5-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"user_input"</span>, <span class="va">None</span>, update_on<span class="op">=</span><span class="st">"blur"</span>, width<span class="op">=</span><span class="st">"100%"</span>,</span>
<span id="cb5-16"><a href="genai-structured-data.html#cb5-16" aria-hidden="true" tabindex="-1"></a>        value<span class="op">=</span><span class="st">"John works at Google in New York. He met with Sarah, the CEO of Acme Inc., last week in San Francisco."</span>,</span>
<span id="cb5-17"><a href="genai-structured-data.html#cb5-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-18"><a href="genai-structured-data.html#cb5-18" aria-hidden="true" tabindex="-1"></a>    ui.input_action_button(<span class="st">"submit"</span>, label<span class="op">=</span><span class="st">"Extract"</span>, icon<span class="op">=</span>icon_svg(<span class="st">"paper-plane"</span>))</span>
<span id="cb5-19"><a href="genai-structured-data.html#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="genai-structured-data.html#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> ui.card():</span>
<span id="cb5-21"><a href="genai-structured-data.html#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> ui.card_header(class_<span class="op">=</span><span class="st">"d-flex justify-content-between align-items-center"</span>):</span>
<span id="cb5-22"><a href="genai-structured-data.html#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">"Extracted (editable) table"</span></span>
<span id="cb5-23"><a href="genai-structured-data.html#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="genai-structured-data.html#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">@render.download</span>(filename<span class="op">=</span><span class="st">"entities.csv"</span>, label<span class="op">=</span><span class="st">"Download CSV"</span>)</span>
<span id="cb5-25"><a href="genai-structured-data.html#cb5-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">async</span> <span class="kw">def</span> download():</span>
<span id="cb5-26"><a href="genai-structured-data.html#cb5-26" aria-hidden="true" tabindex="-1"></a>            d <span class="op">=</span> <span class="cf">await</span> data()</span>
<span id="cb5-27"><a href="genai-structured-data.html#cb5-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> d.to_csv(index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-28"><a href="genai-structured-data.html#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="genai-structured-data.html#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">@render.data_frame</span></span>
<span id="cb5-30"><a href="genai-structured-data.html#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> data_frame():</span>
<span id="cb5-31"><a href="genai-structured-data.html#cb5-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> render.DataGrid(</span>
<span id="cb5-32"><a href="genai-structured-data.html#cb5-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">await</span> data(),</span>
<span id="cb5-33"><a href="genai-structured-data.html#cb5-33" aria-hidden="true" tabindex="-1"></a>            editable<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-34"><a href="genai-structured-data.html#cb5-34" aria-hidden="true" tabindex="-1"></a>            width<span class="op">=</span><span class="st">"100%"</span>,</span>
<span id="cb5-35"><a href="genai-structured-data.html#cb5-35" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-36"><a href="genai-structured-data.html#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="genai-structured-data.html#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="at">@reactive.calc</span></span>
<span id="cb5-38"><a href="genai-structured-data.html#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="at">@reactive.event</span>(<span class="bu">input</span>.user_input)</span>
<span id="cb5-39"><a href="genai-structured-data.html#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> data():</span>
<span id="cb5-40"><a href="genai-structured-data.html#cb5-40" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="cf">await</span> chat_client.extract_data_async(</span>
<span id="cb5-41"><a href="genai-structured-data.html#cb5-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">input</span>.user_input(),</span>
<span id="cb5-42"><a href="genai-structured-data.html#cb5-42" aria-hidden="true" tabindex="-1"></a>        data_model<span class="op">=</span>NamedEntities,</span>
<span id="cb5-43"><a href="genai-structured-data.html#cb5-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-44"><a href="genai-structured-data.html#cb5-44" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(d[<span class="st">"entities"</span>])</span>
<span id="cb5-45"><a href="genai-structured-data.html#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.rename(columns<span class="op">=</span>{<span class="st">"type_"</span>: <span class="st">"type"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/genai-structured-editable.png" class="rounded shadow mb-5 img-fluid figure-img"></p>
<figcaption>Screenshot of the editable structured data app</figcaption>
</figure>
</div>
</section>
<section id="populating-inputs" class="level2">
<h2 class="anchored" data-anchor-id="populating-inputs">Populating inputs</h2>
<p>For data extraction that isn’t tabular in nature, you might consider using extracted data to populate input controls that the user can make changes to.</p>
<p>Building on <a href="https://github.com/google-gemini/cookbook/blob/main/examples/Pdf_structured_outputs_on_invoices_and_forms.ipynb">Google’s invoice and form data extraction example</a>, here’s an example of how you could use structured data to populate input controls (in addition to an editable table).</p>
<details>
<summary>
<code>data_model.py</code>
</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="genai-structured-data.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pydantic <span class="im">import</span> BaseModel, Field</span>
<span id="cb6-2"><a href="genai-structured-data.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="genai-structured-data.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Item(BaseModel):</span>
<span id="cb6-4"><a href="genai-structured-data.html#cb6-4" aria-hidden="true" tabindex="-1"></a>    description: <span class="bu">str</span> <span class="op">=</span> Field(description<span class="op">=</span><span class="st">"The description of the item"</span>)</span>
<span id="cb6-5"><a href="genai-structured-data.html#cb6-5" aria-hidden="true" tabindex="-1"></a>    quantity: <span class="bu">float</span> <span class="op">=</span> Field(description<span class="op">=</span><span class="st">"The Qty of the item"</span>)</span>
<span id="cb6-6"><a href="genai-structured-data.html#cb6-6" aria-hidden="true" tabindex="-1"></a>    gross_worth: <span class="bu">float</span> <span class="op">=</span> Field(description<span class="op">=</span><span class="st">"The gross worth of the item"</span>)</span>
<span id="cb6-7"><a href="genai-structured-data.html#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="genai-structured-data.html#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="genai-structured-data.html#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Invoice(BaseModel):</span>
<span id="cb6-10"><a href="genai-structured-data.html#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Extract the invoice number, date and all list items with description, quantity and gross worth and the total gross worth."""</span></span>
<span id="cb6-11"><a href="genai-structured-data.html#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="genai-structured-data.html#cb6-12" aria-hidden="true" tabindex="-1"></a>    invoice_number: <span class="bu">str</span> <span class="op">=</span> Field(description<span class="op">=</span><span class="st">"The invoice number e.g. 1234567890"</span>)</span>
<span id="cb6-13"><a href="genai-structured-data.html#cb6-13" aria-hidden="true" tabindex="-1"></a>    date: <span class="bu">str</span> <span class="op">=</span> Field(description<span class="op">=</span><span class="st">"The date of the invoice e.g. 10/09/2012"</span>)</span>
<span id="cb6-14"><a href="genai-structured-data.html#cb6-14" aria-hidden="true" tabindex="-1"></a>    items: <span class="bu">list</span>[Item] <span class="op">=</span> Field(</span>
<span id="cb6-15"><a href="genai-structured-data.html#cb6-15" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">"The list of items with description, quantity and gross worth"</span></span>
<span id="cb6-16"><a href="genai-structured-data.html#cb6-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-17"><a href="genai-structured-data.html#cb6-17" aria-hidden="true" tabindex="-1"></a>    total_gross_worth: <span class="bu">float</span> <span class="op">=</span> Field(description<span class="op">=</span><span class="st">"The total gross worth of the invoice"</span>)</span>
<span id="cb6-18"><a href="genai-structured-data.html#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="genai-structured-data.html#cb6-19" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> Invoice.model_rebuild()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>
<code>app.py</code>
</summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="genai-structured-data.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> chatlas <span class="im">as</span> ctl</span>
<span id="cb7-2"><a href="genai-structured-data.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dateparser</span>
<span id="cb7-3"><a href="genai-structured-data.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> faicons</span>
<span id="cb7-4"><a href="genai-structured-data.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-5"><a href="genai-structured-data.html#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="genai-structured-data.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shiny <span class="im">import</span> reactive</span>
<span id="cb7-7"><a href="genai-structured-data.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shiny.express <span class="im">import</span> <span class="bu">input</span>, render, ui</span>
<span id="cb7-8"><a href="genai-structured-data.html#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="genai-structured-data.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> data_model <span class="im">import</span> Invoice</span>
<span id="cb7-10"><a href="genai-structured-data.html#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="genai-structured-data.html#cb7-11" aria-hidden="true" tabindex="-1"></a>ui.page_opts(</span>
<span id="cb7-12"><a href="genai-structured-data.html#cb7-12" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Invoice data extractor"</span>,</span>
<span id="cb7-13"><a href="genai-structured-data.html#cb7-13" aria-hidden="true" tabindex="-1"></a>    fillable<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-14"><a href="genai-structured-data.html#cb7-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-15"><a href="genai-structured-data.html#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="genai-structured-data.html#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> ui.sidebar():</span>
<span id="cb7-17"><a href="genai-structured-data.html#cb7-17" aria-hidden="true" tabindex="-1"></a>    ui.input_text(</span>
<span id="cb7-18"><a href="genai-structured-data.html#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"url"</span>,</span>
<span id="cb7-19"><a href="genai-structured-data.html#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Enter URL to PDF invoice"</span>,</span>
<span id="cb7-20"><a href="genai-structured-data.html#cb7-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"https://storage.googleapis.com/generativeai-downloads/data/pdf_structured_outputs/invoice.pdf"</span>,</span>
<span id="cb7-21"><a href="genai-structured-data.html#cb7-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-22"><a href="genai-structured-data.html#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="genai-structured-data.html#cb7-23" aria-hidden="true" tabindex="-1"></a>    ui.input_task_button(</span>
<span id="cb7-24"><a href="genai-structured-data.html#cb7-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"extract"</span>,</span>
<span id="cb7-25"><a href="genai-structured-data.html#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Extract data"</span>,</span>
<span id="cb7-26"><a href="genai-structured-data.html#cb7-26" aria-hidden="true" tabindex="-1"></a>        class_<span class="op">=</span><span class="st">"btn btn-primary"</span>,</span>
<span id="cb7-27"><a href="genai-structured-data.html#cb7-27" aria-hidden="true" tabindex="-1"></a>        icon<span class="op">=</span>faicons.icon_svg(<span class="st">"person-digging"</span>),</span>
<span id="cb7-28"><a href="genai-structured-data.html#cb7-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-29"><a href="genai-structured-data.html#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="genai-structured-data.html#cb7-30" aria-hidden="true" tabindex="-1"></a>chat_client <span class="op">=</span> ctl.ChatGoogle()</span>
<span id="cb7-31"><a href="genai-structured-data.html#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="genai-structured-data.html#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="at">@reactive.calc</span></span>
<span id="cb7-33"><a href="genai-structured-data.html#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> invoice_data():</span>
<span id="cb7-34"><a href="genai-structured-data.html#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chat_client.extract_data(</span>
<span id="cb7-35"><a href="genai-structured-data.html#cb7-35" aria-hidden="true" tabindex="-1"></a>        ctl.content_pdf_url(<span class="bu">input</span>.url()),</span>
<span id="cb7-36"><a href="genai-structured-data.html#cb7-36" aria-hidden="true" tabindex="-1"></a>        data_model<span class="op">=</span>Invoice,</span>
<span id="cb7-37"><a href="genai-structured-data.html#cb7-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-38"><a href="genai-structured-data.html#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="genai-structured-data.html#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="genai-structured-data.html#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> ui.layout_column_wrap(height_equal<span class="op">=</span><span class="st">"row"</span>):</span>
<span id="cb7-41"><a href="genai-structured-data.html#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="genai-structured-data.html#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> ui.card():</span>
<span id="cb7-43"><a href="genai-structured-data.html#cb7-43" aria-hidden="true" tabindex="-1"></a>        ui.card_header(<span class="st">"Invoice metadata"</span>)</span>
<span id="cb7-44"><a href="genai-structured-data.html#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="genai-structured-data.html#cb7-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">@render.express</span></span>
<span id="cb7-46"><a href="genai-structured-data.html#cb7-46" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> invoice_metadata():</span>
<span id="cb7-47"><a href="genai-structured-data.html#cb7-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">input</span>.extract():</span>
<span id="cb7-48"><a href="genai-structured-data.html#cb7-48" aria-hidden="true" tabindex="-1"></a>                <span class="co">"Click the button to extract data"</span></span>
<span id="cb7-49"><a href="genai-structured-data.html#cb7-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb7-50"><a href="genai-structured-data.html#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="genai-structured-data.html#cb7-51" aria-hidden="true" tabindex="-1"></a>            d <span class="op">=</span> invoice_data()</span>
<span id="cb7-52"><a href="genai-structured-data.html#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="genai-structured-data.html#cb7-53" aria-hidden="true" tabindex="-1"></a>            ui.input_text(</span>
<span id="cb7-54"><a href="genai-structured-data.html#cb7-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">"invoice_number"</span>,</span>
<span id="cb7-55"><a href="genai-structured-data.html#cb7-55" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">"Invoice number"</span>,</span>
<span id="cb7-56"><a href="genai-structured-data.html#cb7-56" aria-hidden="true" tabindex="-1"></a>                value<span class="op">=</span>d[<span class="st">"invoice_number"</span>],</span>
<span id="cb7-57"><a href="genai-structured-data.html#cb7-57" aria-hidden="true" tabindex="-1"></a>                width<span class="op">=</span><span class="st">"auto"</span>,</span>
<span id="cb7-58"><a href="genai-structured-data.html#cb7-58" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb7-59"><a href="genai-structured-data.html#cb7-59" aria-hidden="true" tabindex="-1"></a>            ui.input_date(</span>
<span id="cb7-60"><a href="genai-structured-data.html#cb7-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">"date"</span>,</span>
<span id="cb7-61"><a href="genai-structured-data.html#cb7-61" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">"Date"</span>,</span>
<span id="cb7-62"><a href="genai-structured-data.html#cb7-62" aria-hidden="true" tabindex="-1"></a>                value<span class="op">=</span>dateparser.parse(d[<span class="st">"date"</span>]),</span>
<span id="cb7-63"><a href="genai-structured-data.html#cb7-63" aria-hidden="true" tabindex="-1"></a>                width<span class="op">=</span><span class="st">"auto"</span>,</span>
<span id="cb7-64"><a href="genai-structured-data.html#cb7-64" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb7-65"><a href="genai-structured-data.html#cb7-65" aria-hidden="true" tabindex="-1"></a>            ui.input_numeric(</span>
<span id="cb7-66"><a href="genai-structured-data.html#cb7-66" aria-hidden="true" tabindex="-1"></a>                <span class="st">"total_gross_worth"</span>,</span>
<span id="cb7-67"><a href="genai-structured-data.html#cb7-67" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">"Total gross worth"</span>,</span>
<span id="cb7-68"><a href="genai-structured-data.html#cb7-68" aria-hidden="true" tabindex="-1"></a>                value<span class="op">=</span>d[<span class="st">"total_gross_worth"</span>],</span>
<span id="cb7-69"><a href="genai-structured-data.html#cb7-69" aria-hidden="true" tabindex="-1"></a>                width<span class="op">=</span><span class="st">"auto"</span>,</span>
<span id="cb7-70"><a href="genai-structured-data.html#cb7-70" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb7-71"><a href="genai-structured-data.html#cb7-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-72"><a href="genai-structured-data.html#cb7-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> ui.card():</span>
<span id="cb7-73"><a href="genai-structured-data.html#cb7-73" aria-hidden="true" tabindex="-1"></a>        ui.card_header(<span class="st">"Invoice items"</span>)</span>
<span id="cb7-74"><a href="genai-structured-data.html#cb7-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="genai-structured-data.html#cb7-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">@render.express</span>(fill<span class="op">=</span><span class="va">True</span>, fillable<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-76"><a href="genai-structured-data.html#cb7-76" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> invoice_items():</span>
<span id="cb7-77"><a href="genai-structured-data.html#cb7-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">input</span>.extract():</span>
<span id="cb7-78"><a href="genai-structured-data.html#cb7-78" aria-hidden="true" tabindex="-1"></a>                <span class="co">"Click the button to extract data"</span></span>
<span id="cb7-79"><a href="genai-structured-data.html#cb7-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb7-80"><a href="genai-structured-data.html#cb7-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-81"><a href="genai-structured-data.html#cb7-81" aria-hidden="true" tabindex="-1"></a>            <span class="at">@render.data_frame</span></span>
<span id="cb7-82"><a href="genai-structured-data.html#cb7-82" aria-hidden="true" tabindex="-1"></a>            <span class="kw">def</span> invoice_items_df():</span>
<span id="cb7-83"><a href="genai-structured-data.html#cb7-83" aria-hidden="true" tabindex="-1"></a>                df <span class="op">=</span> pd.DataFrame(invoice_data()[<span class="st">"items"</span>])</span>
<span id="cb7-84"><a href="genai-structured-data.html#cb7-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> render.DataGrid(df, editable<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/genai-invoice-data.png" class="rounded shadow mb-5 img-fluid figure-img"></p>
<figcaption>Screenshot of the editable invoice data app</figcaption>
</figure>
</div>
<!--
TODO: maybe get into this and point to a template?

## Upload input

You can also use a file upload input to allow users to upload document(s) for processing.
In this case, if you want your app to be robust to different types of content, you'll want a way for the user to specify the `data_model` to use for extraction.
-->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="genai-tools.html" class="pagination-link" aria-label="Tool calling">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Tool calling</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="genai-rag.html" class="pagination-link" aria-label="RAG">
        <span class="nav-page-text">RAG</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Proudly supported by <a href="https://www.posit.co/" class="no-icon"><img src="../images/posit-logo-black.svg" alt="Posit" width="80" style="padding-left: 3px;vertical-align:text-top;"></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/posit-dev/py-shiny-site/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li><li><a href="https://github.com/posit-dev/py-shiny-site/edit/main/docs/genai-structured-data.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://discord.gg/yMGCamUMnS">
      <i class="bi bi-discord" role="img" aria-label="Shiny Discord">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/posit-dev/py-shiny/">
      <i class="bi bi-github" role="img" aria-label="Shiny for Python Github">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/posit_pbc">
      <i class="bi bi-twitter" role="img" aria-label="Posit Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/playlist?list=PL9HYL-VRX0oRbLoj3FyL5zeASU5FMDgVe">
      <i class="bi bi-youtube" role="img" aria-label="Shiny YouTube Playlist">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>